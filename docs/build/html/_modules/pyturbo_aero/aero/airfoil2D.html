<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyturbo_aero.aero.airfoil2D &mdash; pyturbo-aero 1.0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> pyturbo-aero
          </a>
              <div class="version">
                1.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/airfoil2D.html">Airfoil 2D</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D"><code class="docutils literal notranslate"><span class="pre">airfoil2D</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/airfoil3D.html">Airfoil 3D</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/airfoil3D.html#pyturbo_aero.aero.airfoil3D.airfoil3D"><code class="docutils literal notranslate"><span class="pre">airfoil3D</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/airfoil3D.html#pyturbo_aero.aero.airfoil3D.stack_type"><code class="docutils literal notranslate"><span class="pre">stack_type</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/channel.html">2D Passage definition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/channel.html#pyturbo_aero.aero.passage2D.passage2D"><code class="docutils literal notranslate"><span class="pre">passage2D</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/helper.html">PyTurbo.helper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/wavy.html">Wavy Airfoil</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/wavy.html#pyturbo_aero.aero.airfoil_wavy.airfoil_wavy"><code class="docutils literal notranslate"><span class="pre">airfoil_wavy</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyturbo-aero</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>pyturbo_aero.aero.airfoil2D</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pyturbo_aero.aero.airfoil2D</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span><span class="n">sin</span><span class="p">,</span><span class="n">radians</span><span class="p">,</span><span class="n">degrees</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="n">atan2</span><span class="p">,</span><span class="n">sqrt</span><span class="p">,</span><span class="n">atan</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize_scalar</span>
<span class="kn">from</span> <span class="nn">..helper</span> <span class="kn">import</span> <span class="n">bezier</span><span class="p">,</span><span class="n">line2D</span><span class="p">,</span><span class="n">ray2D</span><span class="p">,</span><span class="n">arc</span><span class="p">,</span><span class="n">ray2D_intersection</span><span class="p">,</span><span class="n">exp_ratio</span><span class="p">,</span><span class="n">convert_to_ndarray</span><span class="p">,</span><span class="n">derivative</span><span class="p">,</span><span class="n">dist</span><span class="p">,</span><span class="n">pw_bezier2D</span><span class="p">,</span><span class="n">bisect</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">CubicSpline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">copy</span>

<div class="viewcode-block" id="airfoil2D"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D">[docs]</a><span class="k">class</span> <span class="nc">airfoil2D</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Design a 2D Airfoil using bezier curves </span>
<span class="sd">    &quot;&quot;&quot;</span>    

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">alpha1</span><span class="p">,</span><span class="n">alpha2</span><span class="p">,</span><span class="n">axial_chord</span><span class="p">,</span><span class="n">stagger</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor for Airfoil2D </span>

<span class="sd">        Args:</span>
<span class="sd">            alpha1 (float): inlet metal angle of the blade 0 to 90 deg</span>
<span class="sd">            alpha2 (float): outlet metal angle of the blade 0 to 90 deg</span>
<span class="sd">            axial_chord (float): Axial chord of the blade</span>
<span class="sd">            stagger (float): stagger angle measured from trailing edge to leading edge</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alpha1</span> <span class="o">=</span> <span class="n">alpha1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alpha2</span> <span class="o">=</span> <span class="n">alpha2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stagger</span> <span class="o">=</span> <span class="n">stagger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_c</span> <span class="o">=</span> <span class="n">axial_chord</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stagger</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__create_camber</span><span class="p">()</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">alpha1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">alpha2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stagger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stagger</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">chord</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c</span>

    <span class="k">def</span> <span class="nf">__create_camber</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create the camberline of the blade</span>
<span class="sd">            Called by the constructor to automatically build the camberline</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Creates the airfoil camberline</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Assumes CCW, call flip to convert to CW</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_c</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stagger</span><span class="p">))</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stagger</span><span class="p">))</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="n">ray2D</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha1</span><span class="p">)),</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha1</span><span class="p">)))</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">ray2D</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha2</span><span class="p">)),</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha2</span><span class="p">)))</span>

        <span class="c1"># Find intersection Point</span>
        <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">]</span> <span class="o">=</span> <span class="n">ray2D_intersection</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">y2</span><span class="p">]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span> <span class="o">=</span> <span class="n">b</span> <span class="c1"># Save the bezier curve</span>

<div class="viewcode-block" id="airfoil2D.custom_camber"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.custom_camber">[docs]</a>    <span class="k">def</span> <span class="nf">custom_camber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a custom bezier curve camberline from 3 points [LEPoint, (x,y), TEPoint]</span>
<span class="sd">            Usage: </span>
<span class="sd">                Example profile.custom_camber(0.5,0.5)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): arbitrary x coordinate</span>
<span class="sd">            y (float): arbitrary y coordinate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_c</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stagger</span><span class="p">)</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stagger</span><span class="p">)</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">y2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">)</span></div>

<div class="viewcode-block" id="airfoil2D.le_thickness_add"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.le_thickness_add">[docs]</a>    <span class="k">def</span> <span class="nf">le_thickness_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thickness</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">counter_rotation</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds thickness to leading edge either on pressure side or suction side. </span>
<span class="sd">           If counter rotation is false, thickness is added to the suction side </span>

<span class="sd">        Args:</span>
<span class="sd">            thickness (float): float value for defining a bezier curve thickness</span>
<span class="sd">            counter_rotation (bool, optional): switches the side for the bezier curve initial thickness. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_le_thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_counter_rotation</span><span class="o">=</span><span class="n">counter_rotation</span> <span class="c1"># self basically swaps the pressure side and suction size</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># First point is always the start of the camberline</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Add Thickness to the suction side </span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">counter_rotation</span><span class="p">):</span>
            <span class="n">theta_ss</span> <span class="o">=</span> <span class="mi">180</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ss</span><span class="p">))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_le_thickness</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ss</span><span class="p">))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_le_thickness</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">theta_ps</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ps</span><span class="p">))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_le_thickness</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ps</span><span class="p">))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_le_thickness</span><span class="p">)</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">b</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span> <span class="o">=</span> <span class="n">b</span></div>
    
<div class="viewcode-block" id="airfoil2D.le_thickness_match"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.le_thickness_match">[docs]</a>    <span class="k">def</span> <span class="nf">le_thickness_match</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Matches the second derivative by changing the thickness of the opposite side</span>

<span class="sd">        Args:</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: error in matching the second derivative</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Point that controls the thickness is index [1] </span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="mf">0.001</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="mf">0.002</span>

        <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>   <span class="c1"># Derivative on the suction side (Needs to match)</span>
        <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
        <span class="n">dydx1</span> <span class="o">=</span> <span class="n">derivative</span><span class="o">.</span><span class="n">derivative_2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="n">theta_ps</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha1</span>
        
        <span class="k">def</span> <span class="nf">nest_ps_derivative2</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ps</span><span class="p">))</span><span class="o">*</span><span class="n">h</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ps</span><span class="p">))</span><span class="o">*</span><span class="n">h</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span>
            <span class="n">xx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">[</span><span class="n">xx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">yy</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span> <span class="c1"># Gets the second derivative near the leading edge</span>
            <span class="p">[</span><span class="n">xx</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">yy</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
            <span class="n">dydx2</span> <span class="o">=</span> <span class="n">derivative</span><span class="o">.</span><span class="n">derivative_2</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
            <span class="n">err</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dydx2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dydx1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">err</span>

        <span class="k">def</span> <span class="nf">nest_ss_derivative2</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ps</span><span class="p">))</span><span class="o">*</span><span class="n">h</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ps</span><span class="p">))</span><span class="o">*</span><span class="n">h</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span>
            <span class="n">xx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">[</span><span class="n">xx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">yy</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
            <span class="p">[</span><span class="n">xx</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">yy</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="mf">0.002</span><span class="p">)</span>
            <span class="n">dydx2</span> <span class="o">=</span> <span class="n">derivative</span><span class="o">.</span><span class="n">derivative_2</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
            <span class="n">err</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dydx2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dydx1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">err</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counter_rotation</span><span class="p">):</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">minimize_scalar</span><span class="p">(</span><span class="n">nest_ps_derivative2</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_le_thickness</span><span class="o">*</span><span class="mi">30</span><span class="p">),</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;bounded&quot;</span><span class="p">)</span> 
            <span class="n">h</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">x</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">nest_ps_derivative2</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_le_thickness</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ps</span><span class="p">))</span><span class="o">*</span><span class="n">h</span>  <span class="c1"># Changes the second point to match the second derivative at the leading edge </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ps</span><span class="p">))</span><span class="o">*</span><span class="n">h</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">minimize_scalar</span><span class="p">(</span><span class="n">nest_ss_derivative2</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_le_thickness</span><span class="o">*</span><span class="mi">30</span><span class="p">),</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;bounded&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">nest_ss_derivative2</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_le_thickness</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ps</span><span class="p">))</span><span class="o">*</span><span class="n">h</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_ps</span><span class="p">))</span><span class="o">*</span><span class="n">h</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="airfoil2D.te_create"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.te_create">[docs]</a>    <span class="k">def</span> <span class="nf">te_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">radius</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">wedge_ss</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">wedge_ps</span><span class="p">:</span><span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates the trailing edge using a semi-circle</span>

<span class="sd">        Args:</span>
<span class="sd">            radius (float): circle radius</span>
<span class="sd">            wedge_ss (float): wedge angle on the suction side</span>
<span class="sd">            wedge_ps (float): wedge angle on the pressure side</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">te_radius</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">te_wedge_ss</span> <span class="o">=</span> <span class="n">wedge_ss</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">te_wedge_ps</span> <span class="o">=</span> <span class="n">wedge_ps</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span>
        <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Get the last point</span>
        <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_point_dt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span><span class="n">dx</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">theta</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span><span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span><span class="o">+</span><span class="mi">90</span>
        
        
        <span class="c1"># Pressure side</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ps</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">[</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">([</span><span class="n">t</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mf">0.01</span><span class="p">])</span>
        <span class="n">m2</span> <span class="o">=</span> <span class="n">derivative</span><span class="o">.</span><span class="n">derivative_1</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">)</span>
        <span class="n">m2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">m2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">yc</span> <span class="o">=</span> <span class="n">yc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">x_wedge_ps</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="o">-</span><span class="n">wedge_ps</span><span class="p">))</span><span class="o">*</span><span class="n">radius</span>
        <span class="n">y_wedge_ps</span> <span class="o">=</span> <span class="n">y</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="o">-</span><span class="n">wedge_ps</span><span class="p">))</span><span class="o">*</span><span class="n">radius</span>
        
        <span class="n">alpha_start</span> <span class="o">=</span> <span class="n">theta</span><span class="o">-</span><span class="n">wedge_ps</span>
        <span class="n">angle</span> <span class="o">=</span>  <span class="n">alpha_start</span><span class="o">+</span><span class="mi">360</span><span class="o">-</span><span class="p">(</span><span class="n">theta</span><span class="o">+</span><span class="mi">180</span><span class="o">+</span><span class="n">wedge_ps</span><span class="p">)</span>
        <span class="n">alpha_stop</span> <span class="o">=</span> <span class="n">alpha_start</span> <span class="o">-</span><span class="n">angle</span>
        <span class="n">alpha_mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha_start</span> <span class="o">+</span> <span class="n">alpha_stop</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span> <span class="o">=</span> <span class="n">arc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">radius</span><span class="p">,</span><span class="n">alpha_start</span><span class="p">,</span><span class="n">alpha_mid</span><span class="p">)</span>
        <span class="c1"># Pressure Side - Match first derivative</span>
        <span class="c1"># Compute first derivative on the arc</span>
        <span class="p">[</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.02</span><span class="p">])</span>
        <span class="n">dydx1</span> <span class="o">=</span> <span class="n">derivative</span><span class="o">.</span><span class="n">derivative_1</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">dydx1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">xo</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_wedge_ps</span><span class="o">-</span><span class="n">yc</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="n">x_wedge_ps</span><span class="o">+</span><span class="n">m2</span><span class="o">*</span><span class="n">xc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">m2</span><span class="o">-</span><span class="n">m</span><span class="p">)</span>
        <span class="n">yo</span> <span class="o">=</span> <span class="n">y_wedge_ps</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">x_wedge_ps</span><span class="o">-</span><span class="n">xo</span><span class="p">)</span>
        
        
        <span class="c1">#yo = (y_wedge_ps-m*x_wedge_ps)/(1+m*yc/xc)</span>
        <span class="c1">#xo = -yo*yc/xc</span>
        
        <span class="c1"># mc = (yo-y_wedge_ps)/(xo-x_wedge_ps) # Check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">xo</span> <span class="c1"># set the last bezier point on the pressure side such that it matches the slope of the TE Arc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">yo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_wedge_ps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_wedge_ps</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span> <span class="c1"># Extends the bezier curve</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span> <span class="o">=</span> <span class="n">b</span>
        
        <span class="c1"># Suction side</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ss</span><span class="p">))</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># in case a camber percent (i.e. 0.7) is set</span>
            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ss</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        
        <span class="p">[</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">([</span><span class="n">t</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mf">0.01</span><span class="p">])</span>
        <span class="n">m2</span> <span class="o">=</span> <span class="n">derivative</span><span class="o">.</span><span class="n">derivative_1</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">)</span>
        <span class="n">m2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">m2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
        <span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">yc</span> <span class="o">=</span> <span class="n">yc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># find the perpendicular line slope</span>
        <span class="n">x_wedge_ss</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="o">+</span><span class="mi">180</span><span class="o">+</span><span class="n">wedge_ss</span><span class="p">))</span><span class="o">*</span><span class="n">radius</span>
        <span class="n">y_wedge_ss</span> <span class="o">=</span> <span class="n">y</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="o">+</span><span class="mi">180</span><span class="o">+</span><span class="n">wedge_ss</span><span class="p">))</span><span class="o">*</span><span class="n">radius</span>
        
        <span class="n">alpha_start</span> <span class="o">=</span> <span class="n">theta</span><span class="o">-</span><span class="n">wedge_ss</span>
        <span class="n">angle</span> <span class="o">=</span>  <span class="n">alpha_start</span><span class="o">+</span><span class="mi">360</span><span class="o">-</span><span class="p">(</span><span class="n">theta</span><span class="o">+</span><span class="mi">180</span><span class="o">+</span><span class="n">wedge_ss</span><span class="p">)</span>
        <span class="n">alpha_stop</span> <span class="o">=</span> <span class="n">alpha_start</span><span class="o">-</span><span class="n">angle</span>
        <span class="n">alpha_mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha_start</span> <span class="o">+</span> <span class="n">alpha_stop</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span> <span class="o">=</span> <span class="n">arc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">radius</span><span class="p">,</span><span class="n">alpha_stop</span><span class="p">,</span><span class="n">alpha_mid</span><span class="p">)</span>
        <span class="c1"># Suction side - Match first derivative</span>
        <span class="c1"># Compute first derivative on the arc</span>
        <span class="p">[</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.02</span><span class="p">])</span>
        <span class="n">dydx1</span> <span class="o">=</span> <span class="n">derivative</span><span class="o">.</span><span class="n">derivative_1</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">dydx1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">xo</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_wedge_ss</span><span class="o">-</span><span class="n">yc</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="n">x_wedge_ss</span><span class="o">+</span><span class="n">m2</span><span class="o">*</span><span class="n">xc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">m2</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="c1"># interception of the 2nd to last point</span>
        <span class="n">yo</span> <span class="o">=</span> <span class="n">y_wedge_ss</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">x_wedge_ss</span><span class="o">-</span><span class="n">xo</span><span class="p">)</span>
        <span class="c1"># mc = (yo-y_wedge_ss)/(xo-x_wedge_ss) # Check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">xo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">yo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_wedge_ss</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_wedge_ss</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">b</span></div>
        
    
<div class="viewcode-block" id="airfoil2D.ss_thickness_add"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.ss_thickness_add">[docs]</a>    <span class="k">def</span> <span class="nf">ss_thickness_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thicknessArray</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span><span class="n">camberPercent</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">thickness_loc</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">expansion_ratio</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds thickness to the suction side by specifying bezier control points </span>

<span class="sd">        Args:</span>
<span class="sd">            thicknessArray (List[float]): thickness along the suction side. Example: [0.2400, 0.2000, 0.1600, 0.1400]</span>
<span class="sd">            camberPercent (float, optional): Percent camber where straightening of the suction side happens. Defaults to None.</span>
<span class="sd">            thickness_loc (List[float], optional): Location where thickness is applied. Defaults to None.</span>
<span class="sd">            expansion_ratio (float, optional): If thickness location is specified then this is not necessary otherwise thickness_loc is calculated by the expansion ratio. Defaults to 1.2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">thickness_loc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">expansion_ratio</span><span class="p">:</span> <span class="c1"># if expansion ratio is specified              </span>
                <span class="n">t</span> <span class="o">=</span>  <span class="n">exp_ratio</span><span class="p">(</span><span class="n">expansion_ratio</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">thicknessArray</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">camberPercent</span><span class="p">)</span> <span class="c1"># Allocate 2 extra points for continunity at the trailing edge and for flow guidance</span>
                <span class="c1"># Define location of bezier control points from 0 to</span>
                <span class="c1"># camberPercent</span>
            <span class="k">else</span><span class="p">:</span>  
                <span class="n">t</span> <span class="o">=</span> <span class="n">thickness_loc</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">thickness_loc</span> <span class="c1"># Manual custom definition </span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SS_thickness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">thicknessArray</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_ss</span> <span class="o">=</span> <span class="n">t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss_exp_ratio</span> <span class="o">=</span> <span class="n">expansion_ratio</span>
        <span class="n">thicknessArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SS_thickness</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_c</span>
        <span class="c1"># t - array</span>
        <span class="c1"># thicknessArray - distance from camber as an array</span>
        <span class="c1"># Check if camber is defined</span>
        <span class="c1"># Need to add leading and trailing edge points</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
            <span class="c1">## Compute the angle perpendicular</span>
            <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="mi">180</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha1</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha2</span><span class="o">-</span><span class="mi">180</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_point_dt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">atan</span><span class="p">(</span><span class="o">-</span><span class="n">dx</span><span class="o">/</span><span class="n">dy</span><span class="p">))</span>
            
            <span class="c1">## Compute the bezier thickness</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">thicknessArray</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">t_ray</span> <span class="o">=</span> <span class="n">thicknessArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">xn</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">*</span><span class="n">t_ray</span>
                <span class="n">yn</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">*</span><span class="n">t_ray</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yn</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span></div>

    <span class="c1"># Adds thickness to pressure side</span>
<div class="viewcode-block" id="airfoil2D.ps_thickness_add"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.ps_thickness_add">[docs]</a>    <span class="k">def</span> <span class="nf">ps_thickness_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thicknessArray</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span><span class="n">expansion_ratio</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add thickness to the pressure side </span>

<span class="sd">        Args:</span>
<span class="sd">            thicknessArray (List[float]): thickness along the suction side. Example: [0.2400, 0.2000, 0.1600, 0.1400]</span>
<span class="sd">            expansion_ratio (float, optional): determines the spacing of the thickness array from leading edge. Defaults to 1.2.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 3 Extra points is added to account for the Leading Edge being</span>
        <span class="c1"># computed and last 2 are for the trailing edge</span>
        
        <span class="n">ps_height_loc</span> <span class="o">=</span> <span class="n">exp_ratio</span><span class="p">(</span><span class="n">expansion_ratio</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">thicknessArray</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">ps_height_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ps_height_loc</span><span class="p">,[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="n">ps_height_loc</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">PS_thickness</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">thicknessArray</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_ps</span> <span class="o">=</span> <span class="n">t</span>
        <span class="n">thicknessArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PS_thickness</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_c</span>
        <span class="c1"># t - array</span>
        <span class="c1"># thicknessArray - distance from camber as an array</span>
        <span class="c1"># Check if camber is defined</span>
        
        <span class="c1"># Need to add leading and trailing edge points</span>
        <span class="c1"># indx = len(self._psBezierX)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
            <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="c1">## Compute the angle perpendicular</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span><span class="mi">0</span><span class="p">):</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha1</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_point_dt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">))</span>
                <span class="c1">#if (theta&gt;0)</span>
                <span class="c1">#    theta = theta-90</span>
                <span class="c1">#else</span>
                <span class="c1">#    theta = theta+90</span>
                <span class="c1">#end</span>
            
            <span class="c1">## Compute the bezier thickness</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># These two points are computed</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">thicknessArray</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># These two points are computed</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">t_ray</span> <span class="o">=</span> <span class="n">thicknessArray</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">xn</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">*</span><span class="n">t_ray</span>
                <span class="n">yn</span> <span class="o">=</span> <span class="n">y</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">*</span><span class="n">t_ray</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yn</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span></div>


<div class="viewcode-block" id="airfoil2D.add_pitch"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.add_pitch">[docs]</a>    <span class="k">def</span> <span class="nf">add_pitch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x_pitch</span><span class="p">:</span><span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds extra pitch by shifting the turbine blade over by a x direction</span>

<span class="sd">        Args:</span>
<span class="sd">            x_pitch (float): [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Pitch_Add Adds pitch or shifts turbine by x direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">x_pitch</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="airfoil2D.shift"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shifts the blade over by x or y direction. LE points +y where TE is at (0,0) Be sure to take into account the rotation of the blade</span>
<span class="sd">            </span>
<span class="sd">        Args:</span>
<span class="sd">            x (float): amount to shift the blade by in x direction</span>
<span class="sd">            y (float): amount to shift the bade by in y direction </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span> <span class="o">+</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span> <span class="o">+</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="p">,</span> <span class="n">pw_bezier2D</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span> <span class="o">+</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span> <span class="o">+</span> <span class="n">y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span>


        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="p">,</span> <span class="n">pw_bezier2D</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">+</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">+</span> <span class="n">y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span></div>


<div class="viewcode-block" id="airfoil2D.get_centroid"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.get_centroid">[docs]</a>    <span class="k">def</span> <span class="nf">get_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the centroid of the airfoil</span>

<span class="sd">        Returns:</span>
<span class="sd">            float,float: centroid x and y coordinates (x,y)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
        <span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="p">[</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="c1"># [x3,y3] = self.TE_ss_arc.get_point(t)</span>
        <span class="c1"># [x4,y4] = self.TE_ps_arc.get_point(t)</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
        <span class="n">yc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y1</span><span class="o">+</span><span class="n">y2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">xc</span><span class="p">,</span><span class="n">yc</span></div>

    <span class="k">def</span> <span class="nf">flip_cw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># FLIP Flips the turbine from CCW to CW design</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CCW</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Flip the Camber</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">)):</span>
            <span class="n">dx</span> <span class="o">=</span>  <span class="n">xc</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xc</span><span class="o">+</span><span class="n">dx</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">)):</span>
            <span class="n">dx</span> <span class="o">=</span>  <span class="n">xc</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xc</span><span class="o">+</span><span class="n">dx</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;pw_bezier2D&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">)):</span>
                    <span class="n">dx</span> <span class="o">=</span>  <span class="n">xc</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">xc</span><span class="o">+</span><span class="n">dx</span>
        
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">)):</span>
                <span class="n">dx</span> <span class="o">=</span>  <span class="n">xc</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xc</span><span class="o">+</span><span class="n">dx</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">)):</span>
                <span class="n">dx</span> <span class="o">=</span>  <span class="n">xc</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xc</span><span class="o">+</span><span class="n">dx</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span>
        
        <span class="n">dx</span> <span class="o">=</span>  <span class="n">xc</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">xc</span><span class="o">+</span><span class="n">dx</span>
        <span class="n">dx</span> <span class="o">=</span>  <span class="n">xc</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">xc</span><span class="o">+</span><span class="n">dx</span>
        
        <span class="c1"># ps_arc_start = self.TE_ps_arc.alpha_start</span>
        <span class="c1"># ps_arc_stop = self.TE_ps_arc.alpha_stop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">alpha_start</span> <span class="o">=</span> <span class="mi">180</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">alpha_start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">alpha_stop</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">alpha_stop</span><span class="o">+</span><span class="mi">180</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">alpha_start</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">alpha_start</span><span class="o">-</span><span class="mi">180</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">alpha_stop</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">alpha_stop</span> <span class="o">-</span> <span class="mi">180</span>

<div class="viewcode-block" id="airfoil2D.flip"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.flip">[docs]</a>    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Swaps the leading edge with trailing edge </span>

<span class="sd">        &quot;&quot;&quot;</span>

         
        <span class="n">y1c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x1c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x1c</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y1c</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cambBezierY</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x1c</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y1c</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">alpha_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">alpha_start</span><span class="o">+</span><span class="mi">180</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">alpha_stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">alpha_stop</span><span class="o">+</span><span class="mi">180</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x1c</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y1c</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">alpha_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">alpha_start</span><span class="o">+</span><span class="mi">180</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">alpha_stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">alpha_stop</span><span class="o">+</span><span class="mi">180</span>
        
        <span class="c1"># Flip Pressure side</span>
        <span class="n">y1ps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x1ps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x1ps</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y1ps</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span>

        <span class="c1"># Flip Suction side</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;pw_bezier2D&#39;</span><span class="p">):</span>
            <span class="n">y1ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">x1ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">x1ss</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">y1ss</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">bezierArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x1ss</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y1ss</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y1ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">x1ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x1ss</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y1ss</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span></div>

    <span class="c1"># Gets the axial chord of the foil</span>
<div class="viewcode-block" id="airfoil2D.get_axial_chord"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.get_axial_chord">[docs]</a>    <span class="k">def</span> <span class="nf">get_axial_chord</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns the axial chord</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: axial_chord</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stagger</span><span class="p">))</span></div>

<div class="viewcode-block" id="airfoil2D.flow_guidance"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.flow_guidance">[docs]</a>    <span class="k">def</span> <span class="nf">flow_guidance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s_c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Straightens out the suction side. This method can agressively straighten out the suction side</span>

<span class="sd">        Args:</span>
<span class="sd">            s_c (float): pitch to chord ratio, used to compute where the throat starts.</span>

<span class="sd">        Returns:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_c</span> <span class="o">=</span> <span class="n">s_c</span>
        <span class="c1"># Compute where throat starts in terms of ts (suction side)</span>
        <span class="p">[</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">ts</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">s_c</span><span class="p">)</span>
        
        <span class="c1"># Find the point at ts (suction side)</span>
        <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
        <span class="c1"># Create a line from self point to the end of the ss bezier</span>
        <span class="c1"># curve</span>
        
        <span class="n">bl</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],[</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="c1"># Bezier line</span>
        <span class="n">m_bl</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="c1"># First derivative of the bezier line and trailing edge must match</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">m_bl</span><span class="o">*</span><span class="n">x</span>
        <span class="c1">## Define the piecewise ss bezier</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="c1"># Remove points from ssBezier</span>
        <span class="n">indx_d</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">)):</span>
            <span class="n">d2</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">d2</span><span class="o">&gt;</span><span class="n">d</span><span class="p">):</span>
                <span class="n">indx_d</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">break</span>
        
        <span class="c1"># SS bezier normal - point on camber line before throat</span>
        <span class="p">[</span><span class="n">xc1</span><span class="p">,</span> <span class="n">yc1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ss</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="mf">0.001</span><span class="p">)</span> 
        <span class="p">[</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ss</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span> 
        <span class="p">[</span><span class="n">xc2</span><span class="p">,</span> <span class="n">yc2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ss</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="mf">0.001</span><span class="p">)</span> 
        <span class="n">m_normal</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">xc2</span><span class="o">-</span><span class="n">xc1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">yc2</span><span class="o">-</span><span class="n">yc1</span><span class="p">)</span> 
        <span class="n">b1</span> <span class="o">=</span> <span class="n">yc</span><span class="o">-</span><span class="n">m_normal</span><span class="o">*</span><span class="n">xc</span>
        <span class="n">sBezier</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">m_normal</span><span class="o">+</span><span class="n">m_bl</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">m_normal</span><span class="p">,</span><span class="n">m_bl</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">[</span><span class="n">b2</span><span class="p">,</span><span class="n">b1</span><span class="p">]</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">sBezier</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xc</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">sBezier</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">thicknessArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SS_thickness</span>
        <span class="n">thicknessArray</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_c</span> <span class="c1"># Much faster way to find the thickness </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Clear out the rest of the suction side</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss_thickness_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ss_exp_ratio</span><span class="p">,</span><span class="n">thicknessArray</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">te_create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">te_radius</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">te_wedge_ss</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">te_wedge_ps</span><span class="p">)</span>
        
        <span class="c1">## Change TE Angle on SS to meet first derivative</span>
        <span class="k">def</span> <span class="nf">match_te_deriv</span><span class="p">(</span><span class="n">wedge</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">te_create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">te_radius</span><span class="p">,</span><span class="n">wedge</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">te_wedge_ps</span><span class="p">)</span>
            <span class="n">bl</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],[</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">m_bl</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="c1"># First derivative at TE must match</span>
            <span class="c1"># Compute first deriv of TE and of bl</span>
            <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="p">[</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="n">m_te</span> <span class="o">=</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>
            <span class="n">dm</span> <span class="o">=</span> <span class="n">m_bl</span><span class="o">-</span><span class="n">m_te</span>
            <span class="k">return</span> <span class="n">dm</span>
        <span class="n">wedge_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">te_wedge_ss</span><span class="o">-</span><span class="mi">20</span>
        <span class="n">wedge_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">te_wedge_ss</span><span class="o">+</span><span class="mi">20</span>
        <span class="p">[</span><span class="n">wedge_ss</span><span class="p">,</span><span class="n">_</span><span class="p">]</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">match_te_deriv</span><span class="p">,</span><span class="n">wedge_min</span><span class="p">,</span><span class="n">wedge_max</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">te_create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">te_radius</span><span class="p">,</span><span class="n">wedge_ss</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">te_wedge_ps</span><span class="p">)</span>
        
        <span class="c1">## Initialize piecewise bezier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">indx_d</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">])</span> <span class="c1"># Modify the bezier points to include an intersection point</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">indx_d</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">])</span>
        <span class="n">bs</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">pw_bezier2D</span><span class="p">([</span><span class="n">bs</span><span class="p">,</span><span class="n">bl</span><span class="p">])</span></div>
    

    <span class="c1"># FlowGuidance2</span>
    <span class="c1"># Use if SS is defined from 0 to a camber percent</span>
<div class="viewcode-block" id="airfoil2D.flow_guidance2"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.flow_guidance2">[docs]</a>    <span class="k">def</span> <span class="nf">flow_guidance2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This function straightens out the suction side by specifying n bezier control points instead of a straight line. </span>

<span class="sd">        Args:.</span>
<span class="sd">            n (int): number of control points, increase this to make straightening more aggressive. Defaults to 8.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span>


        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># Find ending point on trailing edge ss side </span>
        <span class="p">[</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>       
        <span class="c1"># Create a line from x1 to x2</span>
        <span class="n">bl</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="c1"># Append points on the line at equal distance spacing to</span>
        <span class="c1"># ssBezierX,ssBezierY -&gt; define new ssBezier</span>
        <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">bl</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span></div>

 
<div class="viewcode-block" id="airfoil2D.flow_guidance3"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.flow_guidance3">[docs]</a>    <span class="k">def</span> <span class="nf">flow_guidance3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s_c</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Straightens out the suction side. Computes the intersection point of the throat and draws a line, adds bezier points along the line</span>

<span class="sd">        Args:</span>
<span class="sd">            s_c (float): pitch-to-chord ratio</span>
<span class="sd">            n (int): number of bezier control points</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span> <span class="o">=</span> <span class="n">convert_to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">s_c</span> <span class="o">=</span> <span class="n">s_c</span>
        <span class="c1"># Compute where throat starts in terms of ts (suction side)</span>
        <span class="p">[</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span><span class="n">ts</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">s_c</span><span class="p">)</span>
        
        <span class="c1"># Limit suction side to ts</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">exp_ratio</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ss_exp_ratio</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SS_thickness</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ts</span><span class="p">)</span>
        <span class="n">indx</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span>                        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
            <span class="c1">## Compute the angle perpendicular</span>
            <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span><span class="mi">0</span><span class="p">):</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="mi">180</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha1</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha2</span><span class="o">-</span><span class="mi">180</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_point_dt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">atan</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="o">-</span><span class="n">dx</span><span class="o">/</span><span class="n">dy</span><span class="p">))</span>
            
            <span class="c1">## Compute the bezier thickness</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">t_ray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SS_thickness</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_c</span>
                <span class="n">xn</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">*</span><span class="n">t_ray</span>
                <span class="n">yn</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">*</span><span class="n">t_ray</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span> <span class="o">=</span> <span class="n">xn</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span> <span class="o">=</span> <span class="n">yn</span>   
            <span class="n">indx</span><span class="o">=</span><span class="n">indx</span><span class="o">+</span><span class="mi">1</span>
        
        
        <span class="c1"># Find the point at ts (suction side)            </span>
        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="p">[</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>       
        <span class="c1"># Create a line from self point to the end of the ss bezier</span>
        <span class="c1"># curve</span>
        <span class="n">bl</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">])</span>            
        <span class="c1"># Append points on the line at equal distance spacing to</span>
        <span class="c1"># ssBezierX,ssBezierY -&gt; define new ssBezier</span>
        <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">bl</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span> <span class="o">=</span> <span class="n">bezier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">)</span></div>

<div class="viewcode-block" id="airfoil2D.plot_camber"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.plot_camber">[docs]</a>    <span class="k">def</span> <span class="nf">plot_camber</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the camber of the airfoil</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tplot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
        <span class="c1"># plt.ion()</span>
        <span class="n">marker_style</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">markerfacecoloralt</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>

        <span class="p">[</span><span class="n">xcamber</span><span class="p">,</span> <span class="n">ycamber</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">tplot</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xcamber</span><span class="p">,</span><span class="n">ycamber</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">marker_style</span><span class="p">)</span>        
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="airfoil2D.plot2D"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.plot2D">[docs]</a>    <span class="k">def</span> <span class="nf">plot2D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the airfoil</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
        <span class="c1"># plt.ion()</span>
        <span class="p">[</span><span class="n">xcamber</span><span class="p">,</span> <span class="n">ycamber</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xPS</span><span class="p">,</span> <span class="n">yPS</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xSS</span><span class="p">,</span> <span class="n">ySS</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xcamber</span><span class="p">,</span><span class="n">ycamber</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xPS</span><span class="p">,</span><span class="n">yPS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xSS</span><span class="p">,</span><span class="n">ySS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="c1"># Plot the line from camber to the control points</span>
        <span class="c1"># suction side</span>
        <span class="k">for</span> <span class="n">indx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">)):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierX</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezierY</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xcamber</span><span class="p">,</span><span class="n">ycamber</span><span class="p">)</span>
            <span class="n">min_indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">xcamber</span><span class="p">[</span><span class="n">min_indx</span><span class="p">]],[</span><span class="n">y</span><span class="p">,</span><span class="n">ycamber</span><span class="p">[</span><span class="n">min_indx</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
        <span class="c1"># pressure side</span>
        <span class="k">for</span> <span class="n">indx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">)):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierX</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezierY</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xcamber</span><span class="p">,</span><span class="n">ycamber</span><span class="p">)</span>
            <span class="n">min_indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">xcamber</span><span class="p">[</span><span class="n">min_indx</span><span class="p">]],[</span><span class="n">y</span><span class="p">,</span><span class="n">ycamber</span><span class="p">[</span><span class="n">min_indx</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
        <span class="c1"># Plot the Trailing Edge</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
        <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>

        <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="airfoil2D.plot2D_channel"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.plot2D_channel">[docs]</a>    <span class="k">def</span> <span class="nf">plot2D_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pitchChordRatio</span><span class="p">:</span><span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plots the 2D airfoil in a channel with another airfoil given a pitch to chord ratio</span>

<span class="sd">        Args:</span>
<span class="sd">            pitchChordRatio (float): pitch to chord ratio (spacing between airfoils relative to the chord)</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.figure: [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># outputs the Area/A*</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">t_te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xcamber</span><span class="p">,</span> <span class="n">ycamber</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camberBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xPS</span><span class="p">,</span> <span class="n">yPS</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xSS</span><span class="p">,</span> <span class="n">ySS</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t_te</span><span class="p">)</span>
        <span class="n">xSS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xSS</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
        <span class="n">ySS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ySS</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

        <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t_te</span><span class="p">)</span>
        <span class="n">xPS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xPS</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
        <span class="n">yPS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yPS</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        
        <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">x_ss</span><span class="p">,</span> <span class="n">x_ps</span><span class="p">,</span> <span class="n">y_ss</span><span class="p">,</span> <span class="n">y_ps</span><span class="p">,</span><span class="n">turb2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_get</span><span class="p">(</span><span class="n">pitchChordRatio</span><span class="p">)</span>
        
        <span class="n">bcamber2</span><span class="o">=</span><span class="n">turb2</span><span class="o">.</span><span class="n">camberBezier</span>
        <span class="n">bPS2</span> <span class="o">=</span> <span class="n">turb2</span><span class="o">.</span><span class="n">_psBezier</span>
        <span class="n">bSS2</span> <span class="o">=</span> <span class="n">turb2</span><span class="o">.</span><span class="n">_ssBezier</span>

        <span class="p">[</span><span class="n">xcamber2</span><span class="p">,</span> <span class="n">ycamber2</span><span class="p">]</span> <span class="o">=</span> <span class="n">bcamber2</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xPS2</span><span class="p">,</span> <span class="n">yPS2</span><span class="p">]</span> <span class="o">=</span> <span class="n">bPS2</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xSS2</span><span class="p">,</span> <span class="n">ySS2</span><span class="p">]</span> <span class="o">=</span> <span class="n">bSS2</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        
        <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">turb2</span><span class="o">.</span><span class="n">TE_ss_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">xSS2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xSS2</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
        <span class="n">ySS2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ySS2</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

        <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">turb2</span><span class="o">.</span><span class="n">TE_ps_arc</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">xPS2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xPS2</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
        <span class="n">yPS2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yPS2</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        
        
        <span class="c1"># Plot turbine and pitch</span>
        <span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xcamber</span><span class="p">,</span><span class="n">ycamber</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xPS</span><span class="p">,</span><span class="n">yPS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xSS</span><span class="p">,</span><span class="n">ySS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xcamber2</span><span class="p">,</span><span class="n">ycamber2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xPS2</span><span class="p">,</span><span class="n">yPS2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xSS2</span><span class="p">,</span><span class="n">ySS2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>       

        <span class="c1"># Throat</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_ss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x_ps</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="n">y_ss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y_ps</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_ss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">x_ps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],[</span><span class="n">y_ss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">y_ps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>       

        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1.05</span><span class="o">*</span><span class="nb">min</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">xSS</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">xSS2</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">xPS</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">xPS2</span><span class="p">)]),</span><span class="mf">1.05</span><span class="o">*</span><span class="nb">max</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">xSS</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">xSS2</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">xPS</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">xPS2</span><span class="p">)]))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1.05</span><span class="o">*</span><span class="nb">min</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">ySS</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">ySS2</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">yPS</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">yPS2</span><span class="p">)]),</span><span class="mf">1.05</span><span class="o">*</span><span class="nb">max</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">ySS</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">ySS2</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">yPS</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">yPS2</span><span class="p">)]))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="airfoil2D.plot_derivative2"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.plot_derivative2">[docs]</a>    <span class="k">def</span> <span class="nf">plot_derivative2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">400</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Plots the second derivative of the airfoil.</span>

<span class="sd">        References:</span>

<span class="sd">            https://mathformeremortals.wordpress.com/2013/01/12/a-numerical-second-derivative-from-three-points/</span>

<span class="sd">        Args:</span>
<span class="sd">        </span>
<span class="sd">            xlim (list, optional): Plot x-axis. Defaults to [0,1].</span>
<span class="sd">            ylim (list, optional): Plot y-axis. Defaults to [-400,400].</span>

<span class="sd">        &quot;&quot;&quot;</span>
    
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">equal_space</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">equal_space</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">ds2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
        <span class="n">dp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
        <span class="n">alens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># len along the ss and ps side</span>
        <span class="n">alenp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> 
            <span class="n">alens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">alens</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">alenp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">alenp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1">#dx^2 / dy^2</span>
            <span class="n">ds2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">((</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>   \
                <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">((</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>         \
                <span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">((</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

            <span class="n">dp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">((</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>   \
                <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">((</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>         \
                <span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">((</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        
        
        <span class="c1"># Suction side</span>
        <span class="c1"># plt.ion()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alens</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">alens</span><span class="p">),</span><span class="n">ds2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alenp</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">alenp</span><span class="p">),</span><span class="n">dp2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;d^2y/dx^2 suction side&#39;</span><span class="p">,</span><span class="s1">&#39;d^2y/dx^2 pressure side&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;s(x)/s&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;d^2y/dx^2&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>



<div class="viewcode-block" id="airfoil2D.thickness"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.thickness">[docs]</a>    <span class="k">def</span> <span class="nf">thickness</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the location and value of maximum thickness along with average thickness</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: along camberline of max thickness</span>
<span class="sd">            float: max thickness</span>
<span class="sd">            float: average thickness</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xss</span><span class="p">,</span> <span class="n">yss</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="p">[</span><span class="n">xps</span><span class="p">,</span> <span class="n">yps</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="c1"># Points are equally spaced</span>
        <span class="c1"># Compute minimum distance for each point on SS</span>
        <span class="n">d</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">xss</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">min_ps_point</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">xss</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">xx_ps</span><span class="o">=</span><span class="n">xss</span> 
        <span class="n">yy_ps</span><span class="o">=</span><span class="n">xss</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xss</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xps</span><span class="p">)):</span>
                <span class="n">temp</span><span class="o">=</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">xps</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">yss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">yps</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">temp</span><span class="o">&lt;</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">temp</span>
                    <span class="n">min_ps_point</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
                    <span class="n">xx_ps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xps</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">yy_ps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">yps</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        
        <span class="c1"># Find max thickness</span>
        <span class="p">[</span><span class="n">max_thickness</span><span class="p">,</span><span class="n">indx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="c1"># gives value and index</span>
        
        <span class="c1"># Find avg thickness</span>
        <span class="n">avg_thickness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indx</span><span class="p">,</span> <span class="n">max_thickness</span><span class="p">,</span> <span class="n">avg_thickness</span></div>
        <span class="c1"># Find avg thickness</span>
        
        <span class="c1"># Debug plot</span>
    <span class="c1">#             close all</span>
    <span class="c1">#             self.Plot2D[0]</span>
    <span class="c1">#             figure(1)</span>
    <span class="c1">#             hold on</span>
    <span class="c1">#             for i=1:len(t)</span>
    <span class="c1">#                 plot([xss(i) xx_ps(i)],[yss(i) yy_ps(i)],&#39;k&#39;)</span>
    <span class="c1">#             end</span>
    <span class="c1">#             hold off</span>
    <span class="c1">#             [val indx] = max(d)</span>

<div class="viewcode-block" id="airfoil2D.channel_get"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.channel_get">[docs]</a>    <span class="k">def</span> <span class="nf">channel_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s_c</span><span class="p">):</span>        
        <span class="sd">&quot;&quot;&quot;Gets adjacent airfoil </span>

<span class="sd">        Args:</span>
<span class="sd">            s_c (float): pitch to chord ratio</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[float]: pitch in between airfoils</span>
<span class="sd">            numpy.ndarray: x coordinate of the suction side</span>
<span class="sd">            numpy.ndarray: x coordinate of the pressure side</span>
<span class="sd">            numpy.ndarray: y coordinate of the suction side</span>
<span class="sd">            numpy.ndarray: y coordinate of the pressure side</span>
<span class="sd">            airfoil2D: the adjacent airfoil</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">turb2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">turb2</span><span class="o">.</span><span class="n">add_pitch</span><span class="p">(</span><span class="n">s_c</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_c</span><span class="p">)</span>
        <span class="c1"># Generate a bunch of points on the Pressure side (Turbine2) </span>
        <span class="n">t_ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">t_ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>


        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_counter_rotation</span><span class="p">):</span>
            <span class="p">[</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">]</span> <span class="o">=</span> <span class="n">turb2</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t_ps</span><span class="p">)</span>
            <span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t_ss</span><span class="p">)</span> <span class="c1"># Pressure side to suction side</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t_ps</span><span class="p">)</span>
            <span class="p">[</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">]</span> <span class="o">=</span> <span class="n">turb2</span><span class="o">.</span><span class="n">_ssBezier</span><span class="o">.</span><span class="n">get_point</span><span class="p">(</span><span class="n">t_ss</span><span class="p">)</span> <span class="c1"># Pressure side to suction side</span>
        
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_ss</span><span class="p">));</span> <span class="n">x_ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_ss</span><span class="p">));</span> <span class="n">y_ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_ss</span><span class="p">))</span>
        <span class="n">x_ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_ss</span><span class="p">));</span> <span class="n">y_ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_ss</span><span class="p">));</span> <span class="n">t_ss_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_ss</span><span class="p">))</span>
        <span class="c1"># Compute Minimum distance</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_ps</span><span class="p">)):</span>
            <span class="c1"># compute distance from pressure to suction</span>
            <span class="n">dArray</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">y1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span> <span class="c1"># Takes a point on pressure side and</span>
                                        <span class="c1">#   compute the distance to </span>
                                        <span class="c1">#   all points on the suction side</span>
            <span class="n">min_indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dArray</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">dArray</span><span class="p">))</span>
            <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dArray</span><span class="p">[</span><span class="n">min_indx</span><span class="p">]</span>
            <span class="n">x_ps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">y_ps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">x_ss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="n">min_indx</span><span class="p">]</span>
            <span class="n">y_ss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y2</span><span class="p">[</span><span class="n">min_indx</span><span class="p">]</span>
            <span class="n">t_ss_min</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_ss</span><span class="p">[</span><span class="n">min_indx</span><span class="p">]</span>
        
        <span class="n">t_ss</span> <span class="o">=</span> <span class="n">t_ss_min</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># TODO Need to check if this is the most efficient way of doing it</span>
        
        <span class="k">return</span> <span class="n">s</span><span class="p">,</span><span class="n">x_ss</span><span class="p">,</span><span class="n">x_ps</span><span class="p">,</span><span class="n">y_ss</span><span class="p">,</span><span class="n">y_ps</span><span class="p">,</span><span class="n">turb2</span></div>

<div class="viewcode-block" id="airfoil2D.le_radius_estimate"><a class="viewcode-back" href="../../../modules/airfoil2D.html#pyturbo_aero.aero.airfoil2D.airfoil2D.le_radius_estimate">[docs]</a>    <span class="k">def</span> <span class="nf">le_radius_estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Assumes the blade&#39;s leading edge thickness, suction side, pressure side are already defined. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">pass</span></div></div>
        <span class="c1"># t = np.linspace(0,1,100)</span>
        <span class="c1"># [xps,yps] = self._psBezier.get_point(t)</span>
        <span class="c1"># [xss,yss] = self._ssBezier.get_point(t)</span>
        <span class="c1"># xcam = (xss+xps)/2.0</span>
        <span class="c1"># ycam = (yss+yps)/2.0</span>
        
        <span class="c1"># ps_spline = CubicSpline(np.flip(yps),np.flip(xps))</span>
        <span class="c1"># ss_spline = CubicSpline(np.flip(yss),np.flip(xss))</span>
        <span class="c1"># cam_spline = CubicSpline(np.flip(ycam),np.flip(xcam))</span>
        <span class="c1"># y = np.linspace(ycam[0],ycam[-1],100)</span>
        <span class="c1"># xps_interp = ps_spline(y)</span>
        <span class="c1"># xss_interp = ss_spline(y)</span>
        <span class="c1"># x_cam = cam_spline(y)</span>
       
        <span class="c1"># temp_ps = np.abs(np.diff(xps_interp)*np.diff(x_cam))</span>
        <span class="c1"># temp_ss = np.abs(np.diff(xss_interp)*np.diff(x_cam))</span>
        <span class="c1"># blade_area = np.cumsum(temp_ps+temp_ss)</span>
        
        <span class="c1"># # Positioning the Leading Edge Circle</span>
        <span class="c1"># dx_LE = self.cambBezierX[1] - self.cambBezierX[0]</span>
        <span class="c1"># dy_LE = self.cambBezierY[1] - self.cambBezierY[0]</span>
        <span class="c1"># m = sqrt(dx_LE*dx_LE+dy_LE*dy_LE)</span>
        <span class="c1"># dx_LE = dx_LE/m # Normalize the vector at the leading edge</span>
        <span class="c1"># dy_LE = dy_LE/m</span>

        <span class="c1"># # pspline_ss = pspline(xss,yss)</span>
        <span class="c1"># # pspline_ps = pspline(xps,yps)</span>
        <span class="c1"># def find_blade_area(r):</span>
        <span class="c1">#     y_temp = dy_LE * r </span>
        <span class="c1">#     y = np.linspace(ycam[0],ycam[0] + y_temp,50)</span>
        <span class="c1">#     # temp_ps = np.abs(np.diff(ps_spline(y)-cam_spline(y))*np.diff(y))</span>
        <span class="c1">#     # temp_ss = np.abs(np.diff(ss_spline(y)-cam_spline(y))*np.diff(y))</span>
        <span class="c1">#     x_ps = ps_spline(y)</span>
        <span class="c1">#     ps_area_trapz = np.abs(np.trapz(y,x_ps))</span>

        <span class="c1">#     x_ss = ss_spline(y)</span>
        <span class="c1">#     ss_area_trapz = np.abs(np.trapz(y,x_ss))</span>
        <span class="c1">#     blade_area = np.abs(ps_area_trapz-ss_area_trapz) # rectangle integration method</span>
        <span class="c1">#     return blade_area</span>
        

        <span class="c1"># def find_radius(r):</span>
        <span class="c1">#     # Step 1: Pick a radius, get the circle area</span>
        <span class="c1">#     circle_area = pi*r*r</span>
        <span class="c1">#     # Check for circle intersection with pressure side</span>
        <span class="c1">#     blade_area = find_blade_area(r)</span>
         
        <span class="c1">#     return find_blade_area(r)-circle_area</span>
        
        <span class="c1"># res = minimize_scalar(find_radius,bounds=(self._le_thickness/2,self._le_thickness*2),method=&quot;bounded&quot;,tol=1e-6)</span>
        <span class="c1"># r = 0.002 # res.x</span>
        <span class="c1"># find_blade_area(r)</span>
        <span class="c1"># # find_radius(r)</span>
        <span class="c1"># # Debug: Plotting Functions</span>
        <span class="c1"># </span>
        <span class="c1"># fig,ax = plt.subplots()</span>
        <span class="c1"># ax.plot(xps,yps, color=&#39;blue&#39;, linestyle=&#39;solid&#39;, linewidth=2)</span>
        <span class="c1"># ax.plot(xss,yss, color=&#39;red&#39;, linestyle=&#39;solid&#39;, linewidth=2)</span>
        <span class="c1"># ax.plot(xcam,ycam, color=&#39;black&#39;, linestyle=&#39;solid&#39;, linewidth=2)</span>
        <span class="c1"># x = r*np.cos(np.linspace(0,2*pi,50))</span>
        <span class="c1"># y = r*np.sin(np.linspace(0,2*pi,50))</span>
        <span class="c1"># ax.plot(xcam[0]+dx_LE*r+x,ycam[0]+dy_LE*r+y, color=&#39;orange&#39;, linestyle=&#39;solid&#39;, linewidth=1)</span>
        <span class="c1"># ax.set_aspect(&#39;equal&#39;)</span>
        <span class="c1"># plt.show()</span>
        <span class="c1"># for i in np.linspace(0,self._le_thickness,5):</span>
        <span class="c1">#     # Plot the circles in direction of dy and dx</span>
        <span class="c1">#     dy = dy_LE*i</span>
        <span class="c1">#     dx = dx_LE*i</span>
        <span class="c1">#     r = np.sqrt(dy*dy+dx*dx)</span>
        <span class="c1">#     x = r*np.cos(np.linspace(0,2*pi,50))</span>
        <span class="c1">#     y = r*np.sin(np.linspace(0,2*pi,50))</span>
        <span class="c1">#     ax2.plot(xcam[0]+dx_LE*i+x,ycam[0]+dy_LE*i+y, color=&#39;orange&#39;, linestyle=&#39;solid&#39;, linewidth=1)</span>


        <span class="c1"># yy = np.linspace(y[0],y[-1],1000)</span>
        <span class="c1"># for i in np.linspace(0,self._le_thickness,200):</span>
        <span class="c1">#     dy = dy_LE*i</span>
        <span class="c1">#     dx = dx_LE*i</span>
        <span class="c1">#     radius = np.sqrt(dy*dy + dx*dx)</span>
        <span class="c1">#     circle_area.append(pi*radius*radius*180/360)</span>

    


        

        <span class="c1"># fig,(ax1,ax2) = plt.subplots(1,2)</span>
        <span class="c1"># ax1.plot(y[1:],blade_area, color=&#39;red&#39;, linestyle=&#39;solid&#39;, linewidth=2)</span>
        <span class="c1"># ax1.plot(yy[1:],circle_area, color=&#39;blue&#39;, linestyle=&#39;solid&#39;, linewidth=2)</span>

        <span class="c1"># ax2.plot(xps,yps, color=&#39;blue&#39;, linestyle=&#39;solid&#39;, linewidth=2)</span>
        <span class="c1"># ax2.plot(xss,yss, color=&#39;red&#39;, linestyle=&#39;solid&#39;, linewidth=2)</span>
        <span class="c1"># ax2.plot(xcam,ycam, color=&#39;black&#39;, linestyle=&#39;solid&#39;, linewidth=2)</span>
        <span class="c1"># for i in np.linspace(0,self._le_thickness,5):</span>
        <span class="c1">#     # Plot the circles in direction of dy and dx</span>
        <span class="c1">#     dy = dy_LE*i</span>
        <span class="c1">#     dx = dx_LE*i</span>
        <span class="c1">#     r = np.sqrt(dy*dy+dx*dx)</span>
        <span class="c1">#     x = r*np.cos(np.linspace(0,2*pi,50))</span>
        <span class="c1">#     y = r*np.sin(np.linspace(0,2*pi,50))</span>
        <span class="c1">#     ax2.plot(xcam[0]+dx_LE*i+x,ycam[0]+dy_LE*i+y, color=&#39;orange&#39;, linestyle=&#39;solid&#39;, linewidth=1)</span>

        <span class="c1"># ax2.set_aspect(&#39;equal&#39;)</span>
        <span class="c1"># plt.show()</span>


            
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Paht Juangphanich.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>